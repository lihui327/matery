---
title: 关于hexo+github+vercel部署加载不出图片的问题
date: 2022-05-23 13:09:29
categories: blog
tags:
- hexo
- github
- vercel
---

之前我一直以为是因为vercel部署只能用相对路径，不能用绝对路径，看官方文档感觉也是这个理，虽然我也没有完全看懂，不过官方文档只有关于next.js的图片加载问题，没有关于hexo的，因此我在网上查看了许多文章，其中有一篇和我遇到的问题很像，<https://zhuanlan.zhihu.com/p/379621638>，但是按照他的步骤处理后并没有解决问题...

<!-- more -->

#### 问题

在谷歌和百度上搜了很多文章，竟然没有遇到和我有相似问题的人，难以置信，有那么多人玩hexo，竟然没有人遇到和我类似的问题，奇了怪哉。

<img src="https://photo.lihui327.cn/blog/biaoqing/2022-05-23_131714.png" style="zoom:50%;" /> 

最后在某qq群询问一下，某大佬给出了最准确的回复：<u>图床没有ssl证书的话，谷歌会屏蔽图片</u>。

那么如何解决呢？

#### 解决办法

1. 图床配置ssl证书；
2. 换具有ssl证书的图床；
3. 图片全部放在blog目录下；
4. 放弃vercel，我之前直接使用github pages+自定义域名不用ssl证书也能加载图片。

我使用的是七牛云图床，我觉得七牛云还可以，每月免费10g的额度，在国内访问速度还行，质量可以保证，就这么轻易放弃还是有点不舍，那就只能添加ssl证书，但是七牛云需要域名备案才能使用ssl证书，还是是我孤陋寡闻了呢？？？

经过几番摸索，发现并不需要备案，使用免费的证书也可以，我不打算备案，主要是步骤太麻烦，再就是只是个人博客，无盈利计划，虽然备案有很多好处，但还是算了，不想~~。我的域名是腾讯云，其它云服务商我不清楚，但是腾讯云是可以免费申请证书的，一年的有效期，申请流程如下：

1. 进入到域名控制台：<https://console.dnspod.cn/dns/list>.，点击ssl证书

![](https://photo.lihui327.cn/blog/2022/2022-05-23_133350.png) 

2. 进入到我的证书界面，没有证书的可以申请一个免费证书，注意申请的时候需要和七牛云的源站域名一致，否则会出现问题，我用的是子域名photo前缀，那么我申请的就是photo.···.cn的域名证书，还有就是建议不要自定义密钥，用自动生成的密钥。分配时间很快，大概5分钟以内就能申请成功，然后下载证书；
3. 下载证书之前我们要先看七牛云使用的证书是什么格式的，如图

<img src="https://photo.lihui327.cn/blog/2022/2022-05-23_134552.png" style="zoom:80%;" />  

![](https://photo.lihui327.cn/blog/2022/2022-05-23_150245.png) 

可以看到需要pem格式，这里我们下载其它证书

<img src="https://photo.lihui327.cn/blog/2022/2022-05-23_150653.png" style="zoom:80%;" /> 

<img src="https://photo.lihui327.cn/blog/2022/2022-05-23_150937.png" style="zoom:67%;" /> 

4. 解压下载的文件，pem格式可以参考文章<https://help.aliyun.com/document_detail/40526.html>. 我们需要两个，一个是证书，一个是密钥，证书选择`photo.···.cn_bundle.pem`文件，密钥选择`photo.···.cn.key`文件，如图：，之后点击上传，等待部署

![](https://photo.lihui327.cn/blog/2022/2022-05-23_151445.png) 

5. 这时部署cdn，我们会看不到源站域名，就创建一个cdn加速域名，域名和源站域名相同，都为photo.···.cn，进入到腾讯云修改它指定的解析，即将原来源站域名的解析值修改为现在要求的解析值，然后进入到七牛云空间域名管理页面，先配置下面的https，再配置上面的，下面的直接点击显示的证书，然后确定，上面的部署比较慢，大概需要5分钟左右才能完成。不过完成之后就可以了，再次访问就是https协议了，太高兴了，终于弄出来了。

<img src="https://photo.lihui327.cn/blog/2022/2022-05-23_152146.png" style="zoom:67%;" /> 

#### 小结

前前后后大概花了我一天的时间吧，总得来说，遇到的坑比较多，在这里总结经验，相信以后再部署时会快很多。